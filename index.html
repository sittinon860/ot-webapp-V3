<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏•‡∏á / ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠</title>
<style>
body {
  font-family: sans-serif;
  text-align: center;
  background: #121212;
  color: white;
}
input, button {
  margin: 5px;
  padding: 10px;
  border: none;
  border-radius: 5px;
  font-size: 16px;
}
button {
  background: #1db954;
  color: white;
  cursor: pointer;
}
button:hover { background: #17a24f; }

#playlist {
  max-width: 90%;
  margin: 15px auto;
  text-align: left;
  background: #1e1e1e;
  border-radius: 10px;
  padding: 10px;
}
.playlist-item {
  padding: 8px 10px;
  border-bottom: 1px solid #333;
  cursor: pointer;
  color: #ccc;
}
.playlist-item:hover { background: #333; color: white; }
.playlist-item.active {
  background: #1db954;
  color: white;
}
</style>
</head>
<body>

<h2>üéß ‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏•‡∏á / ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ üé∂</h2>

<!-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå -->
<input type="file" id="fileInput" accept="audio/*,video/*" multiple><br>

<!-- ‡πÉ‡∏™‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå -->
<input type="text" id="urlInput" placeholder="‡∏ß‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏û‡∏•‡∏á‡∏´‡∏£‡∏∑‡∏≠ YouTube" style="width:80%;">
<button id="loadUrlBtn">‡πÄ‡∏õ‡∏¥‡∏î</button>

<!-- ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏•‡∏á -->
<div id="songName" style="margin-top:10px;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏•‡πà‡∏ô</div>

<!-- player -->
<audio id="audioPlayer" controls style="display:none;width:90%;margin-top:15px;"></audio>
<video id="videoPlayer" controls style="display:none;" width="90%"></video>
<div id="youtubePlayer" style="display:none;"></div>

<!-- Playlist -->
<h3>üìú ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏•‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ß‡πâ</h3>
<div id="playlist"></div>

<!-- ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° -->
<div style="margin-top:10px;">
  <button id="prevBtn">‚èÆÔ∏è</button>
  <button id="playBtn">‚ñ∂Ô∏è / ‚è∏Ô∏è</button>
  <button id="nextBtn">‚è≠Ô∏è</button>
  <button id="stopBtn">‚èπÔ∏è</button>
</div>

<script>
let files = [];
let currentIndex = 0;
const audio = document.getElementById('audioPlayer');
const video = document.getElementById('videoPlayer');
const youtube = document.getElementById('youtubePlayer');
const playlistDiv = document.getElementById('playlist');
const songName = document.getElementById('songName');

// ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå
document.getElementById('fileInput').addEventListener('change', e => {
  files = Array.from(e.target.files);
  if (files.length > 0) {
    currentIndex = 0;
    renderPlaylist();
    playLocal();
  }
});

// ‡πÅ‡∏™‡∏î‡∏á Playlist
function renderPlaylist() {
  playlistDiv.innerHTML = '';
  files.forEach((file, index) => {
    const div = document.createElement('div');
    div.textContent = `${index + 1}. ${file.name}`;
    div.classList.add('playlist-item');
    if (index === currentIndex) div.classList.add('active');
    div.onclick = () => {
      currentIndex = index;
      playLocal();
      renderPlaylist();
    };
    playlistDiv.appendChild(div);
  });
}

// ‡πÄ‡∏•‡πà‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á
function playLocal() {
  hideAllPlayers();
  const file = files[currentIndex];
  const url = URL.createObjectURL(file);
  songName.textContent = `‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡πà‡∏ô: ${file.name}`;

  const type = file.type || '';
  if (type.startsWith('audio') || file.name.endsWith('.wav')) {
    audio.src = url;
    audio.style.display = 'block';
    audio.play().catch(err => {
      console.error('‡πÄ‡∏•‡πà‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ:', err);
      songName.textContent = '‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡πà‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ';
    });
  } else {
    video.src = url;
    video.style.display = 'block';
    video.play();
  }
  renderPlaylist();
}

// ‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå
document.getElementById('loadUrlBtn').addEventListener('click', () => {
  const url = document.getElementById('urlInput').value.trim();
  if (!url) return;
  hideAllPlayers();

  if (url.includes('youtube.com') || url.includes('youtu.be')) {
    songName.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏à‡∏≤‡∏Å YouTube...';
    youtube.style.display = 'block';
    loadYouTube(url);
  } else {
    songName.textContent = `‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏à‡∏≤‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå: ${url}`;
    if (url.endsWith('.mp4')) {
      video.src = url;
      video.style.display = 'block';
      video.play();
    } else {
      audio.src = url;
      audio.style.display = 'block';
      audio.play();
    }
  }
});

function hideAllPlayers() {
  audio.style.display = 'none';
  video.style.display = 'none';
  youtube.style.display = 'none';
  audio.pause(); video.pause();
}

// ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°
document.getElementById('playBtn').onclick = () => {
  if (audio.style.display === 'block') {
    audio.paused ? audio.play() : audio.pause();
  } else if (video.style.display === 'block') {
    video.paused ? video.play() : video.pause();
  }
};

document.getElementById('nextBtn').onclick = () => {
  if (files.length > 0) {
    currentIndex = (currentIndex + 1) % files.length;
    playLocal();
  }
};
document.getElementById('prevBtn').onclick = () => {
  if (files.length > 0) {
    currentIndex = (currentIndex - 1 + files.length) % files.length;
    playLocal();
  }
};
document.getElementById('stopBtn').onclick = () => {
  audio.pause(); audio.currentTime = 0;
  video.pause(); video.currentTime = 0;
};

// YouTube API
function loadYouTube(url) {
  const videoId = url.split('v=')[1]?.split('&')[0] || url.split('/').pop();
  youtube.innerHTML = `<iframe width="90%" height="315"
    src="https://www.youtube.com/embed/${videoId}?autoplay=1"
    frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>`;
}
</script>

</body>
</html>
