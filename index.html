<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡πÇ‡∏ô‡πá‡∏ï‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏áOT ‡∏£‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà16-15 (‡∏î‡∏π OT ‡∏£‡∏≤‡∏¢‡∏õ‡∏µ)</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-B2CJVLLCLN"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-B2CJVLLCLN');
</script>

<style>
/* ‡∏¢‡πà‡∏≠‡∏™‡πà‡∏ß‡∏ô CSS ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏∏‡∏Å‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏•‡∏¢) */
*{box-sizing:border-box;}body{font-family:Arial,sans-serif;margin:5px;background:linear-gradient(135deg,#f0f4ff,#d9e8ff);}
h2{text-align:center;color:#0d47a1;text-shadow:1px 1px 2px #aaa;margin-bottom:5px;}
.instructions{background:#e3f2fd;border-left:4px solid #1976d2;padding:5px 10px;margin-bottom:5px;font-size:12px;line-height:1.4;}
.credit{text-align:center;font-size:11px;color:#555;margin-bottom:5px;}
.controls{display:flex;flex-wrap:wrap;gap:5px;align-items:center;justify-content:center;margin-bottom:5px;}
select,button{padding:5px 8px;font-size:13px;border-radius:8px;border:1px solid #1976d2;background:linear-gradient(to bottom,#42a5f5,#1e88e5);color:white;cursor:pointer;box-shadow:2px 2px 5px rgba(0,0,0,0.2);transition:transform 0.1s;}
select:hover,button:hover{transform:translateY(-2px);}
#showChartBtn{background:linear-gradient(to bottom,#ff9800,#f57c00);border:1px solid #e65100;}
#showChartBtn:hover{background:linear-gradient(to bottom,#f57c00,#e65100);}
#resetBtn{background:linear-gradient(to bottom,#f44336,#d32f2f);border:1px solid #c62828;}
#resetBtn:hover{background:linear-gradient(to bottom,#d32f2f,#c62828);}
.checkbox-container{display:flex;flex-wrap:wrap;justify-content:center;gap:3px;font-size:12px;margin-bottom:5px;}
.summary{text-align:center;background:linear-gradient(to right,#a8ff78,#78ffd6);padding:5px 10px;border-radius:12px;font-weight:bold;font-size:12px;box-shadow:1px 2px 6px rgba(0,0,0,0.2);margin-bottom:10px;}
table{width:100%;border-collapse:collapse;background:white;font-size:11px;border-radius:12px;overflow:hidden;box-shadow:0 5px 15px rgba(0,0,0,0.2);}
th,td{border:1px solid #ddd;padding:3px;text-align:center;vertical-align:middle;transition:all 0.2s;}
th{background:linear-gradient(to bottom,#1976d2,#42a5f5);color:white;text-shadow:1px 1px 2px #333;}
tr:hover{background:#e3f2fd;transform:scale(1.02);}
.holiday-personal{background:#ffd3d3;border-left:4px solid #ff1744;font-weight:bold;}
.holiday-ot{background:#fff3b2!important;border-left:4px solid #ffc400;font-weight:bold;}
@media(max-width:480px){h2{font-size:16px;}.controls{flex-direction:column;}select,button{font-size:11px;width:100%;}.summary{font-size:11px;}th,td{font-size:10px;padding:1px;}}
.modal{display:none;position:fixed;z-index:100;left:0;top:0;width:100%;height:100%;background-color:rgba(0,0,0,0.6);}
.modal-content{background:#fff;margin:5% auto;padding:20px;border-radius:12px;width:90%;max-width:800px;box-shadow:0 4px 8px rgba(0,0,0,0.2);}
.close-btn{color:#aaa;float:right;font-size:28px;font-weight:bold;}
.close-btn:hover{color:#000;cursor:pointer;}
.chart-container{position:relative;height:400px;width:100%;}
</style>
</head>
<body>

<h2>‡πÇ‡∏ô‡πá‡∏ï‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏áOT ‡∏£‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà16-15</h2>
<div class="controls">
‡πÄ‡∏î‡∏∑‡∏≠‡∏ô: <select id="month"></select>
‡∏õ‡∏µ: <select id="year"></select>
<button id="resetBtn">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</button>
<button id="showChartBtn">‡∏™‡∏£‡∏∏‡∏õ OT ‡∏£‡∏≤‡∏¢‡∏õ‡∏µ</button>
</div>

<div class="summary" id="summary">‡∏£‡∏ß‡∏° OT1:0 | OT1.5:0 | OT3:0</div>

<table id="otTable">
<thead><tr><th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th>‡∏ß‡∏±‡∏ô</th><th>‡∏Å‡∏∞</th><th>‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á OT</th><th>OT1</th><th>OT1.5</th><th>OT3</th><th>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‚Äì‡∏≠‡∏≠‡∏Å</th><th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th></tr></thead>
<tbody></tbody>
</table>

<div id="chartModal" class="modal">
  <div class="modal-content">
    <span class="close-btn">&times;</span>
    <h3 style="text-align:center;">‡∏™‡∏£‡∏∏‡∏õ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á OT ‡∏£‡∏≤‡∏¢‡∏õ‡∏µ</h3>
    <div class="chart-container"><canvas id="otChart"></canvas></div>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded",function(){
const monthSelect=document.getElementById("month");
const yearSelect=document.getElementById("year");
const tbody=document.querySelector("#otTable tbody");
const summary=document.getElementById("summary");
const btn=document.getElementById("showChartBtn");
const modal=document.getElementById("chartModal");
const span=document.querySelector(".close-btn");

// üåü ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î üåü
const savedState = JSON.parse(localStorage.getItem("lastSelectedMonthYear") || "{}");
const now = new Date();
const thisMonth = now.getMonth();
const thisYear = now.getFullYear();

const defaultMonth = savedState.month ?? thisMonth;
const defaultYear = savedState.year ?? thisYear;

// ‡πÇ‡∏´‡∏•‡∏î Dropdown ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ
for(let m=0;m<12;m++){
  const opt=document.createElement("option");
  opt.value=m;
  opt.text=new Date(2025,m).toLocaleString("th-TH",{month:"long"});
  monthSelect.appendChild(opt);
}
for(let y=thisYear-2;y<=thisYear+2;y++){
  const opt=document.createElement("option");
  opt.value=y; opt.text=y;
  yearSelect.appendChild(opt);
}

// ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏à‡∏≤‡∏Å LocalStorage ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
monthSelect.value = defaultMonth;
yearSelect.value = defaultYear;

// ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏µ ‡πÉ‡∏´‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
function saveMonthYearState(){
  localStorage.setItem("lastSelectedMonthYear", JSON.stringify({
    month: parseInt(monthSelect.value),
    year: parseInt(yearSelect.value)
  }));
}

// ==== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡πÑ‡∏°‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç, ‡∏Ñ‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏î‡∏¥‡∏°) ====
// (‡∏¢‡∏Å‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÄ‡∏ä‡πà‡∏ô createTable(), saveData(), updateRow() ‡∏Ø‡∏•‡∏Ø)

function createTable(){
  tbody.innerHTML="";
  const year = parseInt(yearSelect.value);
  const month = parseInt(monthSelect.value);
  const key = `otData_${year}-${month+1}`;
  const data = JSON.parse(localStorage.getItem(key) || "[]");

  // (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏¢‡πà‡∏≠) ‚Äî ‡πÉ‡∏ô‡∏Ç‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á‡∏Ñ‡∏á‡πÑ‡∏ß‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
  for(let i=1;i<=5;i++){
    const tr=document.createElement("tr");
    tr.innerHTML=`<td>${i}/10/${year+543}</td><td>‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>`;
    tbody.appendChild(tr);
  }
  updateSummary();
}

function updateSummary(){
  summary.textContent="‡∏£‡∏ß‡∏° OT1:0 | OT1.5:0 | OT3:0";
}

// ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏µ
monthSelect.addEventListener("change",()=>{
  saveMonthYearState();
  createTable();
});
yearSelect.addEventListener("change",()=>{
  saveMonthYearState();
  createTable();
});

// ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
createTable();

// Modal
btn.onclick = ()=>{ modal.style.display="block"; }
span.onclick = ()=>{ modal.style.display="none"; }
window.onclick = e=>{ if(e.target==modal) modal.style.display="none"; }
});
</script>

</body>
</html>

