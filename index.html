‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏™‡∏£‡∏∏‡∏õ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á OT ‡∏ï‡∏≤‡∏°‡∏£‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 16‚Äì15 ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏£‡∏≤‡∏ü‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏õ‡∏µ
‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡∏Å‡πá‡∏ï‡∏≤‡∏° ‡∏°‡∏µ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡πÉ‡∏´‡πâ‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏¢‡∏¥‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏±‡∏Å‡∏û‡∏ö‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å OT ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ó‡∏¢ (‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå)
üõ†Ô∏è ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á
| ‡∏•‡∏≥‡∏î‡∏±‡∏ö | ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á | ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• |
|---|---|---|
| 1 | ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå | ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì OT3 (‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå) ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏≤‡∏Å‡∏•‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏∞ "HD1/HN1" |
| 2 | ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô createTable() | ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡πÄ‡∏ô‡πâ‡∏ô‡∏™‡∏µ ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå (class holiday-public) ‡∏ô‡∏≠‡∏Å‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß |
| 3 | ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á updateRow() Logic ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì OT | ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Å‡∏±‡∏ö ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå (OT3) ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß (OT1/OT3) ‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤ (OT1.5) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì OT ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà |
| 4 | ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ß‡∏±‡∏ô/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ | ‡πÉ‡∏ä‡πâ toLocaleDateString("th-TH") ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (dd/mm/yyyy) ‡πÅ‡∏•‡∏∞‡∏õ‡∏µ ‡∏û.‡∏®. ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö |
| 5 | ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô updateSummary() | ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏™‡∏£‡∏∏‡∏õ‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏¢‡∏¥‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô |
<hr>
üìÑ ‡πÇ‡∏Ñ‡πâ‡∏î HTML/CSS/JavaScript ‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß
<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡πÇ‡∏ô‡πá‡∏ï‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏áOT ‡∏£‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà16-15 (‡∏î‡∏π OT ‡∏£‡∏≤‡∏¢‡∏õ‡∏µ)</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-B2CJVLLCLN"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-B2CJVLLCLN');
</script>  
<style>
/* CSS ‡∏´‡∏•‡∏±‡∏Å */
* { box-sizing: border-box; }
body { font-family: Arial,sans-serif; margin:5px; background:linear-gradient(135deg,#f0f4ff,#d9e8ff);}
h2{ text-align:center; color:#0d47a1; text-shadow:1px 1px 2px #aaa; margin-bottom:5px;}
.instructions{ background:#e3f2fd; border-left:4px solid #1976d2; padding:5px 10px; margin-bottom:5px; font-size:12px; line-height:1.4;}
.credit{ text-align:center; font-size:11px; color:#555; margin-bottom:5px;}
.controls{ display:flex; flex-wrap:wrap; gap:5px; align-items:center; justify-content:center; margin-bottom:5px;}
/* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏õ‡∏∏‡πà‡∏° */
select,button{ padding:5px 8px; font-size:13px; border-radius:8px; border:1px solid #1976d2; background:linear-gradient(to bottom,#42a5f5,#1e88e5); color:white; cursor:pointer; box-shadow:2px 2px 5px rgba(0,0,0,0.2); transition:transform 0.1s;}
select:hover,button:hover{ transform:translateY(-2px);}
/* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤ */
#showChartBtn{ background:linear-gradient(to bottom,#ff9800,#f57c00); border:1px solid #e65100; }
#showChartBtn:hover{ transform:translateY(-2px); background:linear-gradient(to bottom,#f57c00,#e65100); }
/* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏õ‡∏∏‡πà‡∏°‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• */
#resetBtn{ background:linear-gradient(to bottom,#f44336,#d32f2f); border:1px solid #c62828; }
#resetBtn:hover{ transform:translateY(-2px); background:linear-gradient(to bottom,#d32f2f,#c62828); }

.checkbox-container{ display:flex; flex-wrap:wrap; justify-content:center; gap:3px; font-size:12px; margin-bottom:5px;}
.summary{ text-align:center; background:linear-gradient(to right,#a8ff78,#78ffd6); padding:5px 10px; border-radius:12px; font-weight:bold; font-size:12px; box-shadow:1px 2px 6px rgba(0,0,0,0.2); margin-bottom:10px;}
table{ width:100%; border-collapse:collapse; background:white; font-size:11px; border-radius:12px; overflow:hidden; box-shadow:0 5px 15px rgba(0,0,0,0.2);}
th,td{ border:1px solid #ddd; padding:3px; text-align:center; vertical-align:middle; transition:all 0.2s;}
th{ background:linear-gradient(to bottom,#1976d2,#42a5f5); color:white; text-shadow:1px 1px 2px #333;}
tr:hover{ background:#e3f2fd; transform:scale(1.02); box-shadow:0 4px 10px rgba(0,0,0,0.2);}
input[type="number"], input[type="text"], select{ width:100%; padding:2px; font-size:11px; border-radius:6px; border:1px solid #1976d2; box-shadow:inset 1px 1px 3px rgba(0,0,0,0.1);}
/* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå */
.holiday-public{ background:#ffd3d3; border-left:4px solid #ff1744; font-weight:bold;} 
/* ‡πÄ‡∏î‡∏¥‡∏°‡∏Ñ‡∏∑‡∏≠ holiday-personal */
.holiday-personal{ background:#ffe0b2; border-left:4px solid #ff9800; font-weight:bold;} 
.holiday-ot{ background:#fff3b2 !important; border-left:4px solid #ffc400; font-weight:bold;}
@media(max-width:480px){h2{font-size:16px;} .controls{flex-direction:column;align-items:stretch;} select,button{font-size:11px;width:100%;} .checkbox-container{font-size:10px;} .summary{font-size:11px;} th,td{font-size:10px;padding:1px;} input[type="number"],input[type="text"],select{font-size:10px;}}
.td-shift .shift-label{ font-weight:bold; margin-bottom:2px; display:block; color:#0d47a1; text-shadow:1px 1px 1px #aaa; }
.td-shift select{ border-radius:6px; border:1px solid #1976d2; appearance:none; -webkit-appearance:none; -moz-appearance:none;
background:white url('data:image/svg+xml;utf8,<svg fill="gray" height="12" viewBox="0 0 24 24" width="12" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>') no-repeat right 5px center; background-size:12px 12px;}

/* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Modal (‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü) */
.modal {
    display: none; 
    position: fixed; 
    z-index: 100; 
    left: 0;
    top: 0;
    width: 100%; 
    height: 100%; 
    overflow: auto; 
    background-color: rgba(0,0,0,0.6); 
}
.modal-content {
    background-color: #fefefe;
    margin: 5% auto; 
    padding: 20px;
    border-radius: 12px;
    width: 90%; 
    max-width: 800px; 
    box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);
    animation-name: animatetop;
    animation-duration: 0.4s
}
@keyframes animatetop {
    from {top: -300px; opacity: 0}
    to {top: 0; opacity: 1}
}
.close-btn {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
}
.close-btn:hover,
.close-btn:focus {
    color: #000;
    text-decoration: none;
    cursor: pointer;
}
.chart-container {
    position: relative;
    height: 400px;
    width: 100%;
}
.chart-controls {
    text-align: center;
    margin-bottom: 10px;
    font-size: 14px;
    font-weight: bold;
}
</style>
</head>
<body>

<h2>‡πÇ‡∏ô‡πá‡∏ï‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏áOT ‡∏£‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà16-15</h2>

<div class="instructions">
<b>‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:</b><br>
1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ (‡∏ß‡∏±‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå)<br>
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏∞ (N1, D1, HD1, HN1)<br>
3. ‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á OT (1‚Äì3 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á ‡∏ß‡∏±‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤ ‡∏à‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ "‡∏ï‡∏±‡∏î‡∏Å‡∏•‡∏±‡∏ö")<br>
4. ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì OT1 / OT1.5 / OT3 ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡πÇ‡∏î‡∏¢‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Å‡∏±‡∏ö **‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå (OT3)** ‡∏Å‡πà‡∏≠‡∏ô<br>
5. ‡∏Å‡∏î "‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏≠‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å<br>
6. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÉ‡∏ô LocalStorage
</div>

<div class="credit">‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÄ‡∏ß‡πá‡∏ö‡∏ô‡∏µ‡πâ‡πÇ‡∏î‡∏¢: ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏ô‡∏ô</div>

<div class="controls">
‡πÄ‡∏î‡∏∑‡∏≠‡∏ô: <select id="month"></select>
‡∏õ‡∏µ: <select id="year"></select>
<button id="resetBtn">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</button>
<button id="showChartBtn">‡∏™‡∏£‡∏∏‡∏õ OT ‡∏£‡∏≤‡∏¢‡∏õ‡∏µ</button>
</div>

<div class="checkbox-container">
‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß (‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå):
<label><input type="checkbox" value="1"> ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå</label>
<label><input type="checkbox" value="2"> ‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£</label>
<label><input type="checkbox" value="3"> ‡∏û‡∏∏‡∏ò</label>
<label><input type="checkbox" value="4"> ‡∏û‡∏§‡∏´‡∏±‡∏™</label>
<label><input type="checkbox" value="5"> ‡∏®‡∏∏‡∏Å‡∏£‡πå</label>
<label><input type="checkbox" value="6"> ‡πÄ‡∏™‡∏≤‡∏£‡πå</label>
<label><input type="checkbox" value="0"> ‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå</label>
</div>

<div class="summary" id="summary">‡∏£‡∏ß‡∏° OT1: 0.00 ‡∏ä‡∏°. | OT1.5: 0.00 ‡∏ä‡∏°. | OT3: 0.00 ‡∏ä‡∏°.</div>

<table id="otTable">
<thead>
<tr>
<th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th>‡∏ß‡∏±‡∏ô</th><th>‡∏Å‡∏∞</th><th>‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á OT</th>
<th>OT1</th><th>OT1.5</th><th>OT3</th>
<th>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‚Äì‡∏≠‡∏≠‡∏Å</th><th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
</tr>
</thead>
<tbody></tbody>
</table>

<div id="chartModal" class="modal">
  <div class="modal-content">
    <span class="close-btn">&times;</span>
    <h3 style="text-align:center; color:#0d47a1;">‡∏™‡∏£‡∏∏‡∏õ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á OT ‡∏£‡∏≤‡∏¢‡∏õ‡∏µ</h3>
    
    <div class="chart-controls">
        ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ: <select id="yearChartSelect"></select>
    </div>

    <div class="chart-container">
        <canvas id="otChart"></canvas>
    </div>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded",function(){
const dayNames=["‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå","‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå","‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£","‡∏û‡∏∏‡∏ò","‡∏û‡∏§‡∏´‡∏±‡∏™","‡∏®‡∏∏‡∏Å‡∏£‡πå","‡πÄ‡∏™‡∏≤‡∏£‡πå"];
const monthNamesTH = ["‡∏°.‡∏Ñ.", "‡∏Å.‡∏û.", "‡∏°‡∏µ.‡∏Ñ.", "‡πÄ‡∏°.‡∏¢.", "‡∏û.‡∏Ñ.", "‡∏°‡∏¥.‡∏¢.", "‡∏Å.‡∏Ñ.", "‡∏™.‡∏Ñ.", "‡∏Å.‡∏¢.", "‡∏ï.‡∏Ñ.", "‡∏û.‡∏¢.", "‡∏ò.‡∏Ñ."];
const monthSelect=document.getElementById("month");
const yearSelect=document.getElementById("year");
const yearChartSelect=document.getElementById("yearChartSelect"); // Dropdown ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡πÉ‡∏ô‡∏Å‡∏£‡∏≤‡∏ü
const tbody=document.getElementById("otTable").querySelector("tbody");
const summary=document.getElementById("summary");
const checkboxes=document.querySelectorAll(".checkbox-container input[type=checkbox]");
const modal = document.getElementById("chartModal");
const btn = document.getElementById("showChartBtn");
const span = document.getElementsByClassName("close-btn")[0];
let userHolidays=[];
let otChartInstance = null; // ‡πÄ‡∏Å‡πá‡∏ö instance ‡∏Ç‡∏≠‡∏á‡∏Å‡∏£‡∏≤‡∏ü Chart.js

// ----------------------------------------------------
// 1. ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á 2568/2025)
// ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: 'MM/DD' ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
// ----------------------------------------------------
const publicHolidays = {
    // 2568 (2025) - ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
    '2025': ['01/01', '04/06', '04/13', '04/14', '04/15', '05/01', '05/04', '05/12', '06/03', '07/20', '07/28', '08/12', '10/13', '10/23', '12/05', '12/10', '12/31'],
    // 2567 (2024) - ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
    '2024': ['01/01', '02/26', '04/06', '04/13', '04/15', '04/16', '05/01', '05/04', '05/22', '06/03', '07/22', '07/28', '08/12', '10/14', '10/23', '12/05', '12/10', '12/31'],
    // 2566 (2023) - ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
    '2023': ['01/02', '03/06', '04/06', '04/13', '04/14', '04/17', '05/01', '05/04', '06/05', '07/31', '08/01', '08/14', '10/13', '10/23', '12/05', '12/11']
};

function isPublicHoliday(date) {
    const year = date.getFullYear();
    const monthDay = `${(date.getMonth() + 1).toString().padStart(2, '0')}/${date.getDate().toString().padStart(2, '0')}`;
    const yearStr = year.toString();
    
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏õ‡∏µ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á
    const holidaysForYear = publicHolidays[yearStr] || [];
    
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ä‡∏î‡πÄ‡∏ä‡∏¢ (‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå, ‡∏°‡∏±‡∏Å‡∏à‡∏∞‡∏´‡∏¢‡∏∏‡∏î‡∏ä‡∏î‡πÄ‡∏ä‡∏¢‡∏ß‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ)
    // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å OT ‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢‡∏ô‡∏µ‡πâ ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
    if (holidaysForYear.includes(monthDay)) {
        return true;
    }

    // ‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå (userHolidays) 
    // ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á publicHolidays ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå
    return false;
}

// ----------------------------------------------------
// 2. ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ UI ‡πÅ‡∏•‡∏∞ LocalStorage Key
// ----------------------------------------------------

// ‡πÇ‡∏´‡∏•‡∏î Dropdown ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
for(let m=0;m<12;m++){
  const opt=document.createElement("option"); opt.value=m;
  opt.text=new Date(2025,m).toLocaleString("th-TH",{month:"long"});
  monthSelect.appendChild(opt);
}

// *** ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÄ‡∏™‡∏°‡∏≠ (‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°) ***
const today = new Date();
// ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠ ‡∏ï.‡∏Ñ. (9) ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á (16-31 ‡∏ï.‡∏Ñ.) ‡∏Ç‡∏≠‡∏á‡∏£‡∏≠‡∏ö "‡∏Å.‡∏¢.-‡∏ï.‡∏Ñ."
// ‡πÅ‡∏ï‡πà‡πÇ‡∏î‡∏¢‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏°‡∏±‡∏Å‡∏à‡∏∞‡∏î‡∏π‡∏£‡∏≠‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏∞‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î (16 ‡∏ï.‡∏Ñ. - 15 ‡∏û.‡∏¢.) ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏≠‡∏ö‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
// ‡πÄ‡∏£‡∏≤‡∏à‡∏∂‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≠‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÄ‡∏™‡∏°‡∏≠
let initialMonth = today.getMonth(); // ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (0-11)
let initialYear = today.getFullYear();
// ***************************************************************

monthSelect.value = initialMonth; 
const currentYear=new Date().getFullYear();

// ‡πÇ‡∏´‡∏•‡∏î Dropdown ‡∏õ‡∏µ (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≤‡∏ü)
for(let y=currentYear-2;y<=currentYear+2;y++){
  const opt=document.createElement("option"); opt.value=y; opt.text=y; yearSelect.appendChild(opt);
  const optChart=document.createElement("option"); optChart.value=y; optChart.text=y; yearChartSelect.appendChild(optChart);
}
yearSelect.value=initialYear; // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏õ‡∏µ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
yearChartSelect.value = currentYear; // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏õ‡∏µ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏µ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô


// Event listener ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡πÉ‡∏ô‡∏Å‡∏£‡∏≤‡∏ü
yearChartSelect.addEventListener("change",()=>{
    const selectedYear = parseInt(yearChartSelect.value);
    const { labels, data: monthlyData } = getMonthlySummaryData(selectedYear);
    const chartData = { labels: labels, data: monthlyData };
    renderChart(chartData);
});


// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á Key ‡πÉ‡∏ô LocalStorage
function getKeyData(year, month){ 
    // Key: otData_‡∏õ‡∏µ-‡πÄ‡∏î‡∏∑‡∏≠‡∏ô+1 (‡πÄ‡∏î‡∏∑‡∏≠‡∏ô+1 ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ month ‡∏Ñ‡∏∑‡∏≠ 0-11)
    if(typeof year === 'undefined') year = yearSelect.value;
    if(typeof month === 'undefined') month = monthSelect.value;
    return`otData_${year}-${parseInt(month)+1}`;
}
function getKeyHoliday(){return`holidays_${yearSelect.value}-${parseInt(monthSelect.value)+1}`;}

// ----------------------------------------------------
// 3. ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
// ----------------------------------------------------

function loadHolidays(){
    const saved=JSON.parse(localStorage.getItem(getKeyHoliday())||"[]");
    checkboxes.forEach(cb=>cb.checked=saved.includes(parseInt(cb.value)));
    userHolidays=Array.from(checkboxes).filter(cb=>cb.checked).map(cb=>parseInt(cb.value));
}
checkboxes.forEach(cb=>cb.addEventListener("change",()=>{
    userHolidays=Array.from(checkboxes).filter(c=>c.checked).map(c=>parseInt(c.value));
    localStorage.setItem(getKeyHoliday(),JSON.stringify(userHolidays));
    createTable();
}));
document.getElementById("resetBtn").addEventListener("click",()=>{
    if(confirm("‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• OT ‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")){
        localStorage.removeItem(getKeyData()); 
        localStorage.removeItem(getKeyHoliday());
        createTable();
    }
});

// ----------------------------------------------------
// 4. ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å‡πÅ‡∏•‡∏∞ Logic ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì OT (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á)
// ----------------------------------------------------

function createTable(){
    tbody.innerHTML="";
    loadHolidays();
    
    const currentMonth = parseInt(monthSelect.value);
    const currentYear = parseInt(yearSelect.value);
    
    // Logic: ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô M (‡πÄ‡∏ä‡πà‡∏ô ‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°=9) ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≠‡∏ö 16/M ‡∏ñ‡∏∂‡∏á 15/M+1
    let startDate = new Date(currentYear, currentMonth, 16); 
    let endMonth = currentMonth + 1;
    let endYear = currentYear;
    if (endMonth > 11) {
        endMonth = 0;
        endYear += 1;
    }
    let endDate = new Date(endYear, endMonth, 15);

    const savedData=JSON.parse(localStorage.getItem(getKeyData())||"[]"); 
    let current=new Date(startDate);

    while(current <= endDate){
        const tr=document.createElement("tr");
        const day=current.getDay();
        
        // ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô DD/MM/YYYY ‡∏û.‡∏®. (‡πÉ‡∏ä‡πâ toLocaleDateString)
        const formattedDate = current.toLocaleDateString("th-TH", {day:'2-digit', month:'2-digit', year:'numeric'});
        
        const tdDate=document.createElement("td"); tdDate.textContent=formattedDate; tr.appendChild(tdDate);
        const tdDay=document.createElement("td"); tdDay.textContent=dayNames[day]; tr.appendChild(tdDay);

        // ‡∏Å‡∏∞ (Shift)
        const tdShift=document.createElement("td"); tdShift.classList.add("td-shift");
        const shiftLabel=document.createElement("div"); shiftLabel.classList.add("shift-label"); shiftLabel.textContent=""; tdShift.appendChild(shiftLabel);
        const selectShift=document.createElement("select");
        ["","N1","D1","HD1","HN1"].forEach(v=>{ const opt=document.createElement("option"); opt.value=v; opt.text=v; selectShift.appendChild(opt); });
        tdShift.appendChild(selectShift); tr.appendChild(tdShift);

        // ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á OT
        const tdHours=document.createElement("td");
        const inputHours=document.createElement("input"); inputHours.type="number"; inputHours.min=0; inputHours.max=12; inputHours.step=0.5; inputHours.style.display="none"; 
        tdHours.appendChild(inputHours); tr.appendChild(tdHours);

        const tdOT1=document.createElement("td"), tdOT15=document.createElement("td"), tdOT3=document.createElement("td"); tr.appendChild(tdOT1); tr.appendChild(tdOT15); tr.appendChild(tdOT3);
        const tdTime=document.createElement("td"); tr.appendChild(tdTime);
        const tdNote=document.createElement("td"); const inputNote=document.createElement("input"); inputNote.type="text"; tdNote.appendChild(inputNote); tr.appendChild(tdNote);

        // *** ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ß‡∏±‡∏ô ***
        const isPublic = isPublicHoliday(current);
        const isUserHoliday = userHolidays.includes(day);

        if(isPublic) {
            tr.classList.add("holiday-public"); // ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå
            tdDay.textContent += " (‡∏ô‡∏Ç‡∏±‡∏ï.)";
        } else if(isUserHoliday) {
            tr.classList.add("holiday-personal"); // ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå (‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß)
        }
        
        tbody.appendChild(tr);

        // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ
        const dateStr = formattedDate; 
        const idx=savedData.findIndex(d=>d.date===dateStr);
        if(idx>=0){
            const d=savedData[idx];
            selectShift.value=d.shift; shiftLabel.textContent=d.shift;
            if(d.shift) inputHours.style.display="inline-block";
            inputHours.value=d.hours;
            tdOT1.textContent=d.ot1||""; tdOT15.textContent=d.ot15||""; tdOT3.textContent=d.ot3||"";
            tdTime.textContent=d.time||""; inputNote.value=d.note||"";
            // ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏∞ OT ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î (HD1/HN1) ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ OT ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÉ‡∏î
            if(d.shift=="HD1"||d.shift=="HN1"){ 
                tr.classList.remove("holiday-personal", "holiday-public"); tr.classList.add("holiday-ot"); 
            }
        }

        // Event listener ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Å‡∏∞
        selectShift.addEventListener("change",()=>{
            shiftLabel.textContent=selectShift.value;
            if(selectShift.value){ inputHours.style.display="inline-block"; } else { inputHours.style.display="none"; inputHours.value=""; }
            
            // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á/‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            tr.classList.remove("holiday-personal","holiday-public","holiday-ot");
            if(selectShift.value=="HD1"||selectShift.value=="HN1"){ 
                tr.classList.add("holiday-ot"); 
                inputNote.value="OT ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î"; // ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏
            }
            else if(isPublic){ // ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå
                tr.classList.add("holiday-public");
                inputNote.value="";
            }
            else if(isUserHoliday){ // ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
                tr.classList.add("holiday-personal"); 
                inputNote.value=""; 
            }
            else{ // ‡∏ß‡∏±‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤
                inputNote.value=""; 
            }
            updateRow(tr,selectShift,inputHours,current);
        });

        // Event listener ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
        inputHours.addEventListener("input",()=>{ updateRow(tr,selectShift,inputHours,current); });
        
        // ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏õ‡∏ß‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
        current.setDate(current.getDate()+1);
    }
    updateSummary();
}

function updateRow(tr,selectShift,inputHours,current){
    const tds=tr.querySelectorAll("td");
    const shift=selectShift.value;
    const hours=parseFloat(inputHours.value||0);
    const tdOT1=tds[4], tdOT15=tds[5], tdOT3=tds[6], tdTime=tds[7], tdNote=tds[8].querySelector("input");
    let ot1=0, ot15=0, ot3=0, startTime="";
    
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ß‡∏±‡∏ô
    const isPublic = isPublicHoliday(current);
    const isUserHoliday = userHolidays.includes(current.getDay());

    // Clear previous values
    tdOT1.textContent=""; tdOT15.textContent=""; tdOT3.textContent=""; tdTime.textContent=""; 
    // ‡πÑ‡∏°‡πà‡∏•‡πâ‡∏≤‡∏á‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô OT ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î (‡∏Å‡∏∞ HD1/HN1)
    if(shift !== "HD1" && shift !== "HN1"){ 
        tdNote.value = ""; 
    }

    if(hours > 0){
        // 1. ‡∏Å‡∏∞ OT ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î (HD1/HN1) - ‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏°‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î (OT1 ‡πÅ‡∏•‡∏∞ OT3)
        if(shift=="HD1"||shift=="HN1"){ 
            startTime=(shift=="HD1")?"07:45":"19:45"; 
            if(hours<=8){
                ot1=hours; // 8 ‡∏ä‡∏°. ‡πÅ‡∏£‡∏Å OT1 
            } else {
                ot1=8; 
                ot3=hours-8; // ‡πÄ‡∏Å‡∏¥‡∏ô 8 ‡∏ä‡∏°. OT3
            } 
            tdNote.value="OT ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î";
        }
        // 2. ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå (‡∏Å‡∏∞ D1/N1) - ‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î (OT3 ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)
        else if(isPublic){ 
            ot3=hours; 
            startTime=(shift=="N1")?"03:45":"15:45"; // ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏ï‡∏≤‡∏°‡∏Å‡∏∞ N1/D1
            tdNote.value="OT ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå";
        }
        // 3. ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß (‡∏Å‡∏∞ D1/N1) - ‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î (OT1 ‡πÅ‡∏•‡∏∞ OT3)
        else if(isUserHoliday){ 
            startTime=(shift=="N1")?"03:45":"15:45";
            if(hours<=8){
                ot1=hours;
            } else {
                ot1=8; 
                ot3=hours-8;
            } 
            tdNote.value="OT ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß";
        }
        // 4. ‡∏ß‡∏±‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤ (‡∏Å‡∏∞ D1/N1) - ‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ OT ‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏•‡∏¥‡∏Å‡∏á‡∏≤‡∏ô (OT1.5)
        else if(shift=="N1"||shift=="D1"){ 
            ot15=hours; 
            startTime=(shift=="N1")?"03:45":"15:45"; 
            if(hours > 0 && hours <= 3) {
                 tdNote.value="‡∏ï‡∏±‡∏î‡∏Å‡∏•‡∏±‡∏ö"; 
            }
        }
        
        if(startTime){
            tdTime.textContent=`${startTime} ‚Äì ${addHours(startTime,hours)}`;
        }
    } 
    // Update display with calculated values
    tdOT1.textContent=ot1?ot1.toFixed(2):"";
    tdOT15.textContent=ot15?ot15.toFixed(2):"";
    tdOT3.textContent=ot3?ot3.toFixed(2):"";
    saveData(); 
    updateSummary();
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏≠‡∏Å
function addHours(start,h){ 
    let [hh,mm]=start.split(":").map(Number); 
    // ‡πÅ‡∏õ‡∏•‡∏á‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á OT ‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏≤‡∏ó‡∏µ
    let totalMinutes = (hh * 60) + mm + Math.round(h * 60); 
    let newH = Math.floor(totalMinutes / 60);
    let newM = totalMinutes % 60;
    
    // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô‡∏£‡∏≠‡∏ö 24 ‡∏ä‡∏°.
    newH = newH % 24;
    
    return `${newH.toString().padStart(2,'0')}:${newM.toString().padStart(2,'0')}`; 
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á)
function updateSummary(){
    let ot1=0,ot15=0,ot3=0;
    tbody.querySelectorAll("tr").forEach(tr=>{ 
        ot1+=parseFloat(tr.cells[4].textContent||0); 
        ot15+=parseFloat(tr.cells[5].textContent||0); 
        ot3+=parseFloat(tr.cells[6].textContent||0); 
    });
    // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏™‡∏£‡∏∏‡∏õ‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏° 2 ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
    summary.textContent=`‡∏£‡∏ß‡∏° OT1: ${ot1.toFixed(2)} ‡∏ä‡∏°. | OT1.5: ${ot15.toFixed(2)} ‡∏ä‡∏°. | OT3: ${ot3.toFixed(2)} ‡∏ä‡∏°.`;
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á LocalStorage
function saveData(){
    const data=[];
    tbody.querySelectorAll("tr").forEach(tr=>{
        const date=tr.cells[0].textContent;
        const shift=tr.cells[2].querySelector("select").value;
        const inputHoursElement = tr.cells[3].querySelector("input");
        const hours=parseFloat(inputHoursElement.value||0);
        const ot1=tr.cells[4].textContent;
        const ot15=tr.cells[5].textContent;
        const ot3=tr.cells[6].textContent;
        const time=tr.cells[7].textContent;
        const note=tr.cells[8].querySelector("input").value;
        data.push({date,shift,hours,ot1,ot15,ot3,time,note});
    });
    localStorage.setItem(getKeyData(),JSON.stringify(data));
}

// ----------------------------------------------------
// 5. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≤‡∏ü‡∏™‡∏£‡∏∏‡∏õ OT ‡∏£‡∏≤‡∏¢‡∏õ‡∏µ (12 ‡∏£‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å)
// ----------------------------------------------------

/**
 * ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏£‡∏∏‡∏õ OT ‡∏Ç‡∏≠‡∏á 12 ‡∏£‡∏≠‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÉ‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏
 */
function getMonthlySummaryData(selectedYear) {
    const data = [];
    const labels = [];
    
    // ‡∏ß‡∏ô‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏°.‡∏Ñ. (0) ‡∏ñ‡∏∂‡∏á ‡∏ò.‡∏Ñ. (11) ‡∏Ç‡∏≠‡∏á‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    for (let month = 0; month < 12; month++) {
        
        // ‡πÉ‡∏ä‡πâ getKeyData ‡πÇ‡∏î‡∏¢‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤ month ‡πÅ‡∏•‡∏∞ selectedYear ‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢
        const key = getKeyData(selectedYear, month); 
        const savedData = JSON.parse(localStorage.getItem(key) || '[]'); 

        let ot1 = 0, ot15 = 0, ot3 = 0;
        savedData.forEach(d => {
            ot1 += parseFloat(d.ot1 || 0);
            ot15 += parseFloat(d.ot15 || 0);
            ot3 += parseFloat(d.ot3 || 0);
        });

        // Label ‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô + ‡∏õ‡∏µ‡∏¢‡πà‡∏≠ (‡πÄ‡∏ä‡πà‡∏ô ‡∏°.‡∏Ñ./68)
        labels.push(`${monthNamesTH[month]}/${(selectedYear + 543) % 100}`); 
        data.push({
            monthYear: `${monthNamesTH[month]} ${selectedYear}`,
            ot1: parseFloat(ot1.toFixed(2)),
            ot15: parseFloat(ot15.toFixed(2)),
            ot3: parseFloat(ot3.toFixed(2)),
            total: parseFloat((ot1 + ot15 + ot3).toFixed(2))
        });
    }
    return { labels, data };
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏£‡∏≤‡∏ü
function renderChart(summaryData) {
    const ctx = document.getElementById('otChart').getContext('2d');
    
    if (otChartInstance) {
        otChartInstance.destroy(); // ‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏Å‡πà‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
    }

    otChartInstance = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: summaryData.labels,
            datasets: [
                {
                    label: '‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á OT1', 
                    data: summaryData.data.map(d => d.ot1),
                    backgroundColor: 'rgba(255, 99, 132, 0.8)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 1
                },
                {
                    label: '‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á OT1.5',
                    data: summaryData.data.map(d => d.ot15),
                    backgroundColor: 'rgba(54, 162, 235, 0.8)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 1
                },
                {
                    label: '‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á OT3',
                    data: summaryData.data.map(d => d.ot3),
                    backgroundColor: 'rgba(75, 192, 192, 0.8)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                title: {
                    display: true,
                    text: `‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á OT ‡∏£‡∏ß‡∏°‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó (12 ‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡πà‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏õ‡∏µ ${parseInt(yearChartSelect.value) + 543})`
                },
                tooltip: {
                    callbacks: {
                        label: (tooltipItem) => {
                            const label = tooltipItem.dataset.label || '';
                            const value = tooltipItem.parsed.y;
                            return `${label}: ${value.toFixed(2)} ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á`;
                        },
                        footer: (tooltipItems) => {
                            const currentMonthData = summaryData.data[tooltipItems[0].dataIndex];
                            
                            return [
                                `------------------------`,
                                `OT1: ${currentMonthData.ot1.toFixed(2)} ‡∏ä‡∏°.`,
                                `OT1.5: ${currentMonthData.ot15.toFixed(2)} ‡∏ä‡∏°.`,
                                `OT3: ${currentMonthData.ot3.toFixed(2)} ‡∏ä‡∏°.`,
                                `‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${currentMonthData.total.toFixed(2)} ‡∏ä‡∏°.`
                            ];
                        }
                    }
                }
            },
            scales: {
                x: {
                    stacked: true,
                    title: {
                        display: true,
                        text: '‡∏£‡∏≠‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô'
                    }
                },
                y: {
                    stacked: true,
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: '‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á OT'
                    }
                }
            }
        }
    });
}


// 6. Event Listeners ‡∏´‡∏•‡∏±‡∏Å
monthSelect.addEventListener("change",createTable);
yearSelect.addEventListener("change",createTable);
createTable(); // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô

// Modal Event Listeners
btn.onclick = function() {
    const selectedYear = parseInt(yearChartSelect.value);
    const { labels, data: monthlyData } = getMonthlySummaryData(selectedYear);
    const chartData = { labels: labels, data: monthlyData };

    renderChart(chartData);
    modal.style.display = "block";
}

span.onclick = function() {
    modal.style.display = "none";
}

window.onclick = function(event) {
    if (event.target == modal) {
        modal.style.display = "none";
    }
}

});
</script>

</body>
</html>

